# ホビーRPN電卓 (Ypsilon project版)

TOKYO FLIP-FLOP「ホビーRPN電卓」のファームウェアを独自に改変したものです。

## ホビーRPN電卓について

Tokyo Flip-flopさんが提供している小型のRPN電卓同人ハードです。
本家サイト：https://www.hobby-rpn.com/

## ブランチ

1. mainブランチ
機能追加本流ブランチ。 デフォルトのフォント。 安定した機能。

2. use-other-fontブランチ
フォントを変更したブランチ。 複数フォントを用意する予定。計算機能まmainと同じ。

3. その他ブランチ
機能開発用ブランチ。 基本動作未確認でしょう。

## MAIN機能状況

### "=" 長押しで、全クリアでなくて、xのみ消去

**ステータス**： 済

入力中の内容を修正する方法が無くてクリアが全スタッククリアなのは、入力ミスしたときに痛すぎるので、xだけ消すように変更しました。

スタックを全クリアしたい場合は、0を入れてエンターを3回押しましょう。

### "-" 長押しで、符号反転

**ステータス**： 済

元の仕様は、負の数の入力ができません。

0から引くという手順を踏めば可能ですが、スタックを1つ余計に必要とするのでちょっと不便。

### "/" 長押しで、x<>y(入れ替え)

**ステータス**： 済

ちょっと複雑な計算だと、xとyの入れ替えがあると便利なんですよ。

### "*" 長押しで、平方根

**ステータス**： 済

二乗とか累乗は計算できても、開平は難しいので、入れてみました。


### ディスプレイに2行表示する。

**ステータス**： 済

OLEDも余裕があるので、HP 42sのようにx, yの2行が表示されているとよりわかりやすい。


## フォント変更

フォントはttfファイルがあれば、Adafluet GFXの変換ツールでフォントヘッダー形式に変換することができるが、アウトラインをビットマップにレンダリングしているので、ピクセルで見ると安定していない。
[フォントのエディタ](https://tchapi.github.io/Adafruit-GFX-Font-Customiser/)で整形する必要がある。

AdafluetのGFXでは、フォントの容量を圧縮できるように、一部の文字のグリフだけを持って動けるようになっている。
必要なのは、 0-9の数字、,(ドット)、+(プラス)、-(マイナス)、I,N,F,a(INFとNaN用)だけ。 (おまけで,(カンマ)も入れてある)


### Voyeger風フォント

[HPミュージアムにあるVoyegerのttfフォント](https://www.hpmuseum.org/cgi-sys/cgiwrap/hpmuseum/articles.cgi?read=286)を元にビットマップを作成。

[実際に表示したところ](readme-image/Voyeger7seg.jpg)

ただし、フォントの並びが普通のものと違うのか、変換ツールの問題なのか、正しく取り出せなかった。
なんとか形は抽出できたので、それをベースに先ずは"8"を作って、そこから数字のフォントを作った。
記号とアルファベットのフォントについては、7セグは無視することにした。



